<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>submit tests</title>
  <link rel="stylesheet" href="../../../../static/tests/qunit-2.1.1.css">
</head>
<body>
	<script>testing = true</script>
  	<script src="../../../../static/js/jquery.min.js"></script>
  	<script src="../../../../static/tests/qunit-2.1.1.js"></script>
 	<script src="../../../../static/tests/sinon-1.17.7.js"></script>
   	<script src="../js/submit.js"></script>
  	<script>
  	
	  	var server, sandbox;
	  	
	  	QUnit.testStart(function () {
			server = sinon.fakeServer.create(); 
		  	sandbox = sinon.sandbox.create();
	  	});
	  	
	  	QUnit.testDone(function () {
	  		server.restore(); 
	  		sandbox.restore();
	  		// remove the error box if present - as it is attached to the body element I'm not sure
	  		//the qunit-fixture thing will apply
	  		if (document.getElementById('error')) {
	  			document.getElementsByTagName('body')[0].removeChild(document.getElementById('error'));
	  		}
	  	});
	  	
	  	QUnit.test("test showErrorBox", function (assert) {
	  		submit.showErrorBox('This is my error report');
	  		assert.ok(document.getElementById('error'));
	  		assert.notEqual(document.getElementById('error').innerHTML.indexOf('This is my error report'), -1);
	  	});
	  	
	  	QUnit.test("test handleError1", function (assert) {
	  		submit.handleError('save', {"status": 401}, 'author');
	  		assert.ok(document.getElementById('error'));
	  		assert.notEqual(document.getElementById('error').innerHTML.indexOf('You are not authorised to save an entry in the author table.'), -1);
	  	});
	  	
	  	QUnit.test("test handleError2", function (assert) {
	  		submit.handleError('save', {"status": 409}, 'author');
	  		assert.ok(document.getElementById('error'));
	  		assert.notEqual(document.getElementById('error').innerHTML.indexOf('It is not possible to save this author because an entry already exists with the same id.'), -1);
	  	});
	  	
	  	//TODO: more appropriate tests needed for handle Error as the error messages in the current code
	  	//reflect magpy not django - they probably need changing
	  	QUnit.test("test save", function (assert) {
	  		
	  	});

  	</script> 

  	<script>testing = false</script>
  	<div id="qunit"></div>
 	<div id="qunit-fixture">
 	
  		
	</div>  
</body>
</html>	  	
	  	